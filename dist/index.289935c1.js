const t=async()=>({products:await fetch("https://fakestoreapi.com/products").then(t=>t.json()),users:await fetch("https://fakestoreapi.com/users").then(t=>t.json())});class e{constructor({title:t,image:e,price:s},{name:r}){this.price=s,this.imageUrl=e,this.title=t,this.seller=r.firstname+" "+r.lastname,this.discount=10,this.createProductCardElements()}createCardElement(t,e=""){let s=document.createElement(t);return s.classList.add(e),s}createProductCardElements(){let t=this.createCardElement("div","products__card"),e=this.createCardElement("div","image-block"),s=this.createCardElement("img","products__image");s.setAttribute("src",this.imageUrl),s.setAttribute("alt","product image");let r=this.createCardElement("button","quick-show");r.textContent="Быстрый просмотр";let i=this.createCardElement("span","discount");i.textContent="- "+this.discount+" %";let a=this.createCardElement("button","add-to-cart-btn");a.textContent="В корзину";let c=this.createCardElement("div","products__price"),n=this.createCardElement("span","reduced-price");n.textContent=(this.price-this.price*this.discount/100).toFixed(2)+" р.";let o=this.createCardElement("span","initial-price");o.textContent=this.price+" р.";let d=this.createCardElement("div","products__description"),l=this.createCardElement("p","seller");l.textContent=this.seller;let h=this.createCardElement("p","description");h.textContent=this.title,e.append(s,r,i,a),c.append(n,o),d.append(l,h),t.append(e,c,d),this.productCard=t}}const s=new class{constructor(){this._users=[],this._products=[],this.amountOfProducts=0,this.searchText="",this.discoutRate=10}getInitialModelData=async()=>{let{users:e,products:s}=await t();this.users=e,this.products=s};set users(t){this._users=t}get users(){return this._users}get products(){return this._getProductsBySearchText(this._products)}set products(t){this._products=t}_getProductsBySearchText(t){return this.searchText?t.filter(t=>t.title.toLowerCase().includes(this.searchText.toLocaleLowerCase())):t}},r=new class{constructor(){this.productsSection=document.querySelector(".products__container"),this.searchInput=document.querySelector(".search-input"),this.slider=document.querySelector(".slider")}createCard(t,s){return new e(t,s)}},i=new class{constructor(t,e){this.model=t,this.view=e}searchProduct=t=>{this.view.slider.style.display="none",this.model.searchText=t.target.value,""===t.target.value&&(this.view.slider.style.display="block"),this.start()};handleClicks(){this.view.searchInput.addEventListener("input",this.searchProduct)}start=async function(){await this.model.getInitialModelData(),console.log(this.model.products,this.model.users);let t=document.querySelector(".products__container");for(let e of(t.innerHTML="",this.model.products)){console.log();let s=this.view.createCard(e,{name:{firstname:"john",lastname:"doe"}});t.append(s.productCard)}this.handleClicks()}}(s,r);addEventListener("DOMContentLoaded",i.start());